<!DOCTYPE html>


<!--
 | Generated by Apache Maven Doxia Site Renderer 2.0.0-M16 from src/site/markdown/index.md at 2024-12-22
 | Rendered using Apache Maven Fluido Skin 2.0.0-M6
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 2.0.0-M16" />
    <title>OpenWMS.org TMS: Routing Services – Intention</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-2.0.0-M6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-2.0.0-M6.min.js"></script>
    <style>.github-fork-ribbon:before { background-color: black; }</style>
  </head>
  <body class="topBarEnabled">
    <a class="github-fork-ribbon left-top" href="https://github.com/openwms/org.openwms.tms.routing" data-ribbon="Fork me on GitHub" title="Fork me on GitHub">Fork me on GitHub</a>
    <header id="topbar" class="navbar navbar-fixed-top ">
      <div class="navbar-inner">
            <div class="container">
              <a data-target=".nav-collapse" data-toggle="collapse" class="btn btn-navbar">
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
              </a>
          <nav class="nav-collapse">
<a class="brand" href="index.html"  title="OpenWMS.org"><img src="images/logo.png" alt="OpenWMS.org" />
</a>
            <ul class="nav">
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown">Documentation <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li><a title="Home">Home</a></li>
            <li><a href="../../org.openwms.tms.routing.lib/rest/2.0.0-SNAPSHOT/api.html" title="REST API Documentation">REST API Documentation</a></li>
            <li><a href="https://wiki.openwms.cloud/projects/tms-routing-service/wiki" title="Wiki">Wiki</a></li>
            <li><a href="../../org.openwms.tms.routing.lib/apidocs/index.html" title="Javadoc">Javadoc</a></li>
            <li><a href="../../org.openwms.tms.routing.lib/2.0.0-SNAPSHOT/schemaspy/relationships.html" title="Database Schema">Database Schema</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <a class="dropdown-toggle" data-toggle="dropdown">Project <b class="caret"></b></a>
        <ul class="dropdown-menu">
            <li class="dropdown-submenu">
<a href="project-info.html" title="Project Information">Project Information</a>
              <ul class="dropdown-menu">
                  <li><a title="About">About</a></li>
                  <li><a href="summary.html" title="Summary">Summary</a></li>
                  <li><a href="team.html" title="Team">Team</a></li>
                  <li><a href="issue-management.html" title="Issue Management">Issue Management</a></li>
                  <li><a href="ci-management.html" title="CI Management">CI Management</a></li>
                  <li><a href="scm.html" title="Source Code Management">Source Code Management</a></li>
              </ul>
            </li>
            <li class="dropdown-submenu">
<a href="project-reports.html" title="Project Reports">Project Reports</a>
              <ul class="dropdown-menu">
                  <li><a href="apidocs/index.html" title="Javadoc">Javadoc</a></li>
                  <li><a href="surefire-report.html" title="Surefire">Surefire</a></li>
              </ul>
            </li>
        </ul>
      </li>
            </ul>
          </nav>
          <div class="nav-collapse">
          </div>
        </div>
      </div>
    </header>
    <div class="container">
      <header>
        <div id="banner">
          <div class="pull-left"></div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2024-12-22<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.0.0-SNAPSHOT</li>
          </ul>
        </div>
      </header>
        <main id="bodyColumn" >
<section>
<h1>Intention</h1>
<p>The TMS Routing service is used in automatic warehouses to route <code>TransportUnits</code> on conveyors through the warehouse. It is responsible to
handle incoming messages and selects the appropriate workflow process that finally executes the handling. The workflow is a BPMN 2.0
compliant workflow, with extensions of the used workflow engine.</p></section><section>
<h1>Resources</h1>
<p>Documentation at <a href="https://wiki.openwms.cloud/projects/tms-routing-service/wiki" class="externalLink">Wiki</a></p>
<p><a href="https://github.com/openwms/org.openwms.tms.routing/actions/workflows/master-build.yml" class="externalLink"><img src="https://github.com/openwms/org.openwms.tms.routing/actions/workflows/master-build.yml/badge.svg" alt="Build status" /></a>
<a href="LICENSE"><img src="https://img.shields.io/badge/License-Apache%202.0-blue.svg" alt="License" /></a>
<a href="https://hub.docker.com/r/openwms/org.openwms.tms.routing" class="externalLink"><img src="https://img.shields.io/docker/pulls/openwms/org.openwms.tms.routing" alt="Docker pulls" /></a>
<a href="https://gitter.im/openwms/org.openwms?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge" class="externalLink"><img src="https://badges.gitter.im/Join%20Chat.svg" alt="Join the chat at https://gitter.im/openwms/org.openwms" /></a></p></section><section>
<h1>Details</h1>
<p>A typical and simple workflow to handle incoming OSIP REQ_ messages could look like this:</p>
<p><img src="images/workflow.png" alt="Workflow" /></p>
<p>(1) Whenever a REQ_ message arrives, the <code>TransportUnit</code> with the given <code>Barcode</code> is booked onto the <code>Location</code> provided in the message.</p>
<p>(2) For the current <code>TransportUnit</code> a <code>TransportOrder</code> is created with the target <code>LocationGroup</code> equals to <code>FGSTOCK</code>.</p>
<p>(3) In the final step the system triggers a service to send an OSIP RES_ message to the underlying subsystem (i.e. PLC or Raspberry Pi) with
the next <code>Location</code> coordinate to move the <code>TransportUnit</code> to.</p>
<p>The shown BPMN snippet looks in XML like this:</p>

<div class="verbatim">
<pre><code>    &lt;serviceTask id=&quot;Task1&quot; name=&quot;Book to current Location&quot; activiti:expression=&quot;#{transportUnitApi.moveTU(in.msg.barcode, in.msg.actualLocationId)}&quot; /&gt;
    &lt;serviceTask id=&quot;Task2&quot; name=&quot;Create TransportOrder to Stock&quot; activiti:expression=&quot;#{transportOrderApi.createTO(&amp;quot;FGSTOCK&amp;quot;)}&quot;&gt;&lt;/serviceTask&gt;
    &lt;serviceTask id=&quot;Task3&quot; name=&quot;Send OSIP RES telegram&quot; activiti:expression=&quot;#{responder.sendTo(in.msg.flexField1)}&quot;&gt;&lt;/serviceTask&gt;
</code></pre></div>
<p>Notice that the flow and the expressions are modeled in <a href="https://www.flowable.org" class="externalLink">Flowable</a> Model Explorer and there are extensions to the
BPMN standard. Other supported workflow engines like Camunda or Activiti have their own XML namespace extensions, but the XML element names
are almost the same.</p><section>
<h2>Benefits</h2>
<p>Why did we choose BPMN for the transport management system? From the experience we have from projects and systems in the past we know that
the physical layout of a system and the material flow is something that always needs to be adopted to the particular customer project.
Changing the material flow must happen rapidly without any compilation nor deployment interruption.</p>
<p>The second huge benefit of using BPMN for the material flow handling is the advantage of having the same notation for business people as
well as software engineers, so both can define and communicate on the same process models.</p>
<p>Usually after doing a couple of projects an engineer or the project team has a library of well known business functions that they can use to
build new flows for new customer projects. Not only the microservice functions can be reused across projects but also BPMN flows. We misuse
the concept of BPMN for a good purpose :-)</p></section><section>
<h2>Features</h2>
<p>The current implementation allows to refer standard Spring managed beans within BPMN workflows. Remotely http accessible microservices can
be accessed with support of <code>Feign</code>. Therefor the TMS Routing service needs to have the Feign client interface definitions on the classpath
at startup, by simple extending the classpath with the JAR file when the process is started.</p><section>
<h3>Static Routing</h3>
<p>Requests from a PLC for a next target can be answered statically by using a routing table. For this reason a <code>Route</code> may have <code>RouteDetails</code>
entries in a defined order (ordered by the <code>pos</code> attribute). The actual location from the telegram is used to determine the next target. In
the selected workflow a call to <code>#{routing.sendToNextLocation()}</code> chooses the next routing location.</p></section><section>
<h3>Hard Coded Routing</h3>
<p>The workflow that calls the microservice to send the request telegram could pass the next <code>Location</code> hard-coded within the workflow. This is
more or less the simplest solution but has the drawback that the workflow may not be reused, because the target is hard-coded.</p></section><section>
<h3>Dynamic Routing</h3>
<p>Dynamic routing is another strategy in contrast to static or hard-coded routing. The workflow can be customized with so-called
<em>Flex Attributes</em>. This means a workflow can be called with parameters and these parameters come from a defined <code>Action</code>. The <code>Action</code> might
be specific to the project. BPMN workflows should be reusable across projects - <code>Actions</code> may not.</p></section></section></section><section>
<h1>Configuration</h1>
<p>The following Spring profiles are currently supported:
<code>ASYNCHRONOUS</code> - Run with AMQP communication
<code>CAMUNDA</code> - Enable Camunda as workflow engine
<code>DISTRIBUTED</code> - Enables the service to run in a microservice system
<code>FLOWABLE</code> - Use Flowable as workflow engine (default)</p></section><section>
<h1>Development</h1><section>
<h2>Build</h2>
<p>To build an executable JAR file that can run either in a standalone or in a distributed environment call:</p>

<div class="verbatim">
<pre><code>$ mvn package
</code></pre></div></section><section>
<h2>Run</h2>
<p>After the deliverable has been built it can be started with:</p>

<div class="verbatim">
<pre><code>$ java -jar target/openwms-tms-routing-exec.jar
</code></pre></div>
<p>In case the service has been started in a distributed environment along a central configuration server and service registry the
<code>DISTRIBUTED</code> profile needs to be activated. For processing over AMQP also the <code>ASYNCHRONOUS</code> profile must be active:</p>

<div class="verbatim">
<pre><code>$ java -jar target/openwms-tms-routing-exec.jar --spring.profiles.active=DISTRIBUTED,ASYNCHRONOUS
</code></pre></div>
<p>The service is also available as Docker image on Docker Hub and can be started with:</p>

<div class="verbatim">
<pre><code>$ docker run -it openwms/org.openwms.tms.routing:latest
</code></pre></div></section></section><section>
<h1>Appendix</h1><section>
<h2>Further reading</h2>
<table class="table table-striped">
<thead>
<tr class="a">
<th>ID</th>
<th>Description</th></tr></thead><tbody>
<tr class="b">
<td>L001</td>
<td><a href="https://github.com/openwms/org.openwms/wiki/Secured-Eureka-First-services-on-Heroku" class="externalLink">Secured Eureka First Microservices</a></td></tr>
<tr class="a">
<td>L002</td>
<td><a href="development.html">Development Process</a></td></tr></tbody>
</table></section></section>
        </main>
    </div>
    <hr/>
    <footer>
      <div class="container">
        <div class="row">
            <p>©      2005–2024
<a href="https://www.interface21.io">Interface21.io</a>
</p>
        </div>
        <p id="poweredBy" class="pull-right"><a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
</p>
      </div>
    </footer>
<script>
  if(anchors) {
    anchors.add();
  }
</script>
  </body>
</html>